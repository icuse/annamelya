import{a as S}from"./chunk-FI3YU3J3.js";import{e as I,g as D,q as ue,r as de,s as fe,t as ge,u as ve,x as he}from"./chunk-PFGW5BXG.js";import{C as me,P as pe,a as H,f as re,g as ce,h as le,i as q,j as se,k as K}from"./chunk-O2MEU7K7.js";import{Ac as ae,Gb as z,Hb as r,Ib as p,Jb as v,Pa as j,Pb as M,Qb as U,Rb as te,S as ee,Sa as a,Sb as ie,Ta as g,Tb as $,Y as R,Z as k,a as Y,b as G,ba as B,ga as f,gb as d,ha as O,kb as l,oa as N,ob as o,pa as A,pb as n,qb as s,r as X,rb as V,ub as b,vc as ne,wb as h,wc as P,x as Z,xc as x,zc as oe}from"./chunk-AQ6B44A5.js";var Fe=t=>["/countries/by",t];function we(t,u){t&1&&(o(0,"div",2),r(1,` No hay pa\xEDses que mostrar
`),n())}function Re(t,u){if(t&1&&(o(0,"tr")(1,"td"),r(2),n(),o(3,"td"),r(4),n(),o(5,"td"),s(6,"img",5),n(),o(7,"td"),r(8),n(),o(9,"td"),r(10),n(),o(11,"td"),r(12),n(),o(13,"td")(14,"a",6),r(15,"info"),n()()()),t&2){let e=u.$implicit,i=u.index;a(2),p(i+1),a(2),v(" ",e.flag," "),a(2),l("src",e.flags.svg,j)("alt",e.name.common),a(2),p(e.name.common),a(2),p(e.capital),a(2),p(e.population),a(2),l("routerLink",U(8,Fe,e.cca3))}}function ke(t,u){if(t&1&&(o(0,"table",3)(1,"thead")(2,"tr")(3,"th"),r(4,"#"),n(),o(5,"th"),r(6,"Icon"),n(),o(7,"th"),r(8,"Bandera"),n(),o(9,"th"),r(10,"Nombre"),n(),o(11,"th"),r(12,"Capital"),n(),o(13,"th"),r(14,"Poblaci\xF3n"),n(),s(15,"th"),n()(),o(16,"tbody"),d(17,Re,16,10,"tr",4),n()()),t&2){let e=h();a(17),l("ngForOf",e.countries)}}var T=(()=>{class t{countries=[];static \u0275fac=function(i){return new(i||t)};static \u0275cmp=f({type:t,selectors:[["counries-table"]],inputs:{countries:"countries"},decls:3,vars:2,consts:[["table",""],["class","alert alert-warning text-center",4,"ngIf","ngIfElse"],[1,"alert","alert-warning","text-center"],[1,"table","table-hover"],[4,"ngFor","ngForOf"],[3,"src","alt"],[3,"routerLink"]],template:function(i,c){if(i&1&&d(0,we,2,0,"div",1)(1,ke,18,1,"ng-template",null,0,$),i&2){let m=z(2);l("ngIf",c.countries.length===0)("ngIfElse",m)}},dependencies:[P,x,q],styles:["img[_ngcontent-%COMP%]{width:25px}"]})}return t})();function Be(t,u){t&1&&s(0,"shared-loading-spiner")}var _e=(()=>{class t{countriesService;countries=[];isLoading=!1;initialValue="";constructor(e){this.countriesService=e}searchByCapital(e){this.isLoading=!0,this.countriesService.searchCapital(e).subscribe(i=>{this.countries=i,this.isLoading=!1})}ngOnInit(){this.countries=this.countriesService.cacheStore.byCapital.countries,this.initialValue=this.countriesService.cacheStore.byCapital.term}static \u0275fac=function(i){return new(i||t)(g(S))};static \u0275cmp=f({type:t,selectors:[["app-by-capital-page"]],decls:9,vars:3,consts:[[1,"row"],[1,"col"],["placeholder","Buscar por capital",3,"onDebounce","initialValue"],[4,"ngIf"],[3,"countries"]],template:function(i,c){i&1&&(s(0,"hr"),o(1,"div",0)(2,"div",1)(3,"shared-search-box",2),b("onDebounce",function(y){return c.searchByCapital(y)}),n()()(),s(4,"hr"),d(5,Be,1,0,"shared-loading-spiner",3),o(6,"div",0)(7,"div",1),s(8,"counries-table",4),n()()),i&2&&(a(3),l("initialValue",c.initialValue),a(2),l("ngIf",c.isLoading),a(3),l("countries",c.countries))},dependencies:[x,I,D,T],encapsulation:2})}return t})();function Oe(t,u){t&1&&s(0,"shared-loading-spiner")}var be=(()=>{class t{countriesService;countries=[];isLoading=!1;initialValue="";constructor(e){this.countriesService=e}searchByCountry(e){this.isLoading=!0,this.countriesService.searchCountry(e).subscribe(i=>{this.countries=i,this.isLoading=!1})}ngOnInit(){this.countries=this.countriesService.cacheStore.byCountries.countries,this.initialValue=this.countriesService.cacheStore.byCountries.term}static \u0275fac=function(i){return new(i||t)(g(S))};static \u0275cmp=f({type:t,selectors:[["app-by-country-page"]],decls:9,vars:3,consts:[[1,"row"],[1,"col"],["placeholder","Buscar por pais",3,"onDebounce","initialValue"],[4,"ngIf"],[3,"countries"]],template:function(i,c){i&1&&(s(0,"hr"),o(1,"div",0)(2,"div",1)(3,"shared-search-box",2),b("onDebounce",function(y){return c.searchByCountry(y)}),n()()(),s(4,"hr"),d(5,Oe,1,0,"shared-loading-spiner",3),o(6,"div",0)(7,"div",1),s(8,"counries-table",4),n()()),i&2&&(a(3),l("initialValue",c.initialValue),a(2),l("ngIf",c.isLoading),a(3),l("countries",c.countries))},dependencies:[x,I,D,T]})}return t})();var Ne=t=>({"btn-outline-primary":t});function Ae(t,u){if(t&1){let e=V();o(0,"button",5),b("click",function(){let c=N(e).$implicit,m=h();return A(m.searchByRegion(c))}),r(1),n()}if(t&2){let e=u.$implicit,i=h();l("ngClass",U(2,Ne,i.selectedRegion===e)),a(),v(" ",e,`
`)}}var Se=(()=>{class t{countriesService;countries=[];regions=["Africa","Americas","Asia","Europe","Oceania"];selectedRegion;isLoading=!1;constructor(e){this.countriesService=e}searchByRegion(e){this.selectedRegion=e,this.isLoading=!0,this.countriesService.searchRegion(e).subscribe(i=>{this.countries=i,this.isLoading=!1})}ngOnInit(){this.countries=this.countriesService.cacheStore.byRegion.countries,this.selectedRegion=this.countriesService.cacheStore.byRegion.region}static \u0275fac=function(i){return new(i||t)(g(S))};static \u0275cmp=f({type:t,selectors:[["app-by-region-page"]],decls:8,vars:2,consts:[[1,"row"],[1,"col","text-center"],["class","btn mx-2 btn-outline-primary ",3,"ngClass","click",4,"ngFor","ngForOf"],[1,"col"],[3,"countries"],[1,"btn","mx-2","btn-outline-primary",3,"click","ngClass"]],template:function(i,c){i&1&&(s(0,"hr"),o(1,"div",0)(2,"div",1),d(3,Ae,2,4,"button",2),n()(),s(4,"hr"),o(5,"div",0)(6,"div",3),s(7,"counries-table",4),n()()),i&2&&(a(3),l("ngForOf",c.regions),a(4),l("countries",c.countries))},dependencies:[ne,P,T]})}return t})();function je(t,u){t&1&&(o(0,"div",2),r(1,` Espere por favor
`),n())}function Ve(t,u){if(t&1&&(o(0,"div",3)(1,"div",4)(2,"div",5)(3,"h2"),r(4," Pais: "),o(5,"strong"),r(6),n()()()(),o(7,"div",4)(8,"div",6)(9,"h3"),r(10," Bandera: "),n(),s(11,"img",7),n(),o(12,"div",8)(13,"h3"),r(14,"Informacion"),n(),o(15,"ul",9)(16,"li",10)(17,"strong"),r(18,"Poblacion: "),n(),r(19),te(20,"number"),n(),o(21,"li",10)(22,"strong"),r(23,"Codigo numerico: "),n(),r(24),n()()()(),o(25,"div",11)(26,"div",8)(27,"h3"),r(28,"Traducciones"),n(),o(29,"div",12)(30,"span",13),r(31),n(),o(32,"span",13),r(33),n(),o(34,"span",13),r(35),n(),o(36,"span",13),r(37),n(),o(38,"span",13),r(39),n(),o(40,"span",13),r(41),n(),o(42,"span",13),r(43),n(),o(44,"span",13),r(45),n(),o(46,"span",13),r(47),n()()()()()),t&2){let e=h();a(6),p(e.country.name.common),a(5),l("src",e.country.flags.svg,j)("alt",e.country.name.common),a(8),v("",ie(20,14,e.country.population)," "),a(5),v("",e.country.cca3," "),a(7),p(e.country.translations.bre.common),a(2),p(e.country.translations.ces.common),a(2),p(e.country.translations.cym.common),a(2),p(e.country.translations.deu.common),a(2),p(e.country.translations.est.common),a(2),p(e.country.translations.fin.common),a(2),p(e.country.translations.ita.common),a(2),p(e.country.translations.kor.common),a(2),p(e.country.translations.per.common)}}var Ee=(()=>{class t{activatedRoute;countriesService;router;country;constructor(e,i,c){this.activatedRoute=e,this.countriesService=i,this.router=c}ngOnInit(){this.activatedRoute.params.pipe(ee(({id:e})=>this.countriesService.searchCountryByAlphaCode(e))).subscribe(e=>e?this.country=e:this.router.navigateByUrl(""))}static \u0275fac=function(i){return new(i||t)(g(re),g(S),g(le))};static \u0275cmp=f({type:t,selectors:[["app-country-page"]],decls:3,vars:2,consts:[["loading",""],["class","",4,"ngIf","ngIfElse"],[1,"alert","alert-info","text-center"],[1,""],[1,"row"],[1,"col-12"],[1,"col-4"],[1,"img-thumbnail",3,"src","alt"],[1,"col"],[1,"list-group"],[1,"list-group-item"],[1,"row","mt-2"],[1,"d-flex","flex-wrap"],[1,"badge","bg-primary","m-1"]],template:function(i,c){if(i&1&&d(0,je,2,0,"ng-template",null,0,$)(2,Ve,48,16,"div",1),i&2){let m=z(1);a(2),l("ngIf",c.country)("ngIfElse",m)}},dependencies:[x,oe]})}return t})();var J=()=>({exact:!0}),Pe=(()=>{class t{static \u0275fac=function(i){return new(i||t)};static \u0275cmp=f({type:t,selectors:[["app-main-page-countries"]],decls:18,vars:8,consts:[[1,"container","my-4"],[1,"nav","nav-pills","justify-content-center","mb-4"],[1,"nav-item"],["routerLink","by-capital","routerLinkActive","active",1,"nav-link",3,"routerLinkActiveOptions"],["routerLink","by-country","routerLinkActive","active",1,"nav-link",3,"routerLinkActiveOptions"],["routerLink","by-region","routerLinkActive","active",1,"nav-link",3,"routerLinkActiveOptions"],["routerLink","populationcopy","routerLinkActive","active",1,"nav-link",3,"routerLinkActiveOptions"]],template:function(i,c){i&1&&(o(0,"div",0)(1,"h2"),r(2,"\xBFC\xF3mo vamos a buscar?"),n(),s(3,"hr"),o(4,"ul",1)(5,"li",2)(6,"a",3),r(7,"Por capital"),n()(),o(8,"li",2)(9,"a",4),r(10,"Por pa\xEDs"),n()(),o(11,"li",2)(12,"a",5),r(13,"Por regi\xF3n"),n()(),o(14,"li",2)(15,"a",6),r(16,"Poblaci\xF3n de Espa\xF1a"),n()()(),s(17,"router-outlet"),n()),i&2&&(a(6),l("routerLinkActiveOptions",M(4,J)),a(3),l("routerLinkActiveOptions",M(5,J)),a(3),l("routerLinkActiveOptions",M(6,J)),a(3),l("routerLinkActiveOptions",M(7,J)))},dependencies:[ce,q,se],encapsulation:2})}return t})();var Ie=(()=>{class t{http;apiUrl="https://servicios.ine.es/wstempus/js/ES/DATOS_METADATAOPERACION/22?p=12&g1=70:&date=:&page=1";constructor(e){this.http=e}getPopulationData(){return this.http.get(this.apiUrl)}static \u0275fac=function(i){return new(i||t)(B(H))};static \u0275prov=R({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();var De=(()=>{class t{http;apiUrl="https://public.opendatasoft.com/api/records/1.0/search/?dataset=georef-spain-provincia&rows=100";constructor(e){this.http=e}getCommunitiesAndProvinces(){return this.http.get(this.apiUrl).pipe(X(e=>this.transformData(e.records)))}transformData(e){let i=[];return e.forEach(c=>{let m=c.fields.acom_name,y=c.fields.prov_name,C=c.fields.population,E=i.find(w=>w.name===m);E||(E={name:m,provinces:[],showProvinces:!1},i.push(E)),E.provinces.push({name:y,population:C})}),i}static \u0275fac=function(i){return new(i||t)(B(H))};static \u0275prov=R({token:t,factory:t.\u0275fac,providedIn:"root"})}return t})();function He(t,u){t&1&&s(0,"shared-loading-spiner")}function qe(t,u){if(t&1&&(o(0,"li"),r(1),n()),t&2){let e=u.$implicit;a(),v(" ",e.name," ")}}function Je(t,u){if(t&1&&(o(0,"ul"),d(1,qe,2,1,"li",12),n()),t&2){let e=h().$implicit;a(),l("ngForOf",e.provinces)}}function Ye(t,u){if(t&1){let e=V();o(0,"div",9)(1,"mat-card",10)(2,"mat-card-header")(3,"mat-card-title"),r(4),n(),o(5,"mat-card-subtitle")(6,"mat-icon"),r(7,"group"),n(),r(8),n(),o(9,"mat-card-subtitle")(10,"mat-icon"),r(11,"calendar_today"),n(),r(12," Year: 2022 "),n(),o(13,"button",11),b("click",function(){let c=N(e).$implicit,m=h();return A(m.toggleProvinces(c.name))}),o(14,"mat-icon"),r(15),n()()(),o(16,"mat-card-content")(17,"p"),r(18),n(),d(19,Je,2,1,"ul",6),n()()()}if(t&2){let e=u.$implicit,i=h();a(4),p(e.name),a(4),v(" Population: ",e.population," "),a(7),v(" ",i.toggledCommunities[e.name]?"expand_less":"expand_more"," "),a(3),v("Number of Provinces: ",e.provinces.length,""),a(),l("ngIf",i.toggledCommunities[e.name])}}var Te=(()=>{class t{populationService;provincesService;populationData=[];communities=[];combinedData=[];filteredData=[];isLoading=!1;searchTerm="";toggledCommunities={};constructor(e,i){this.populationService=e,this.provincesService=i}ngOnInit(){this.isLoading=!0,this.loadData()}loadData(){Z({populationData:this.populationService.getPopulationData(),communities:this.provincesService.getCommunitiesAndProvinces()}).subscribe(({populationData:e,communities:i})=>{this.populationData=e.map(c=>({region:c.Nombre,year:2022,population:c.Data.find(m=>m.Anyo===2021)?.Valor||0})),this.communities=i,this.combineData(),this.isLoading=!1})}normalizeRegionName(e){return e.toLowerCase().replace(/rioja, la/g,"la rioja").replace(/balears, illes/g,"illes balears").replace(/castilla - la mancha/g,"castilla-la mancha").replace(/madrid, comunidad de/g,"comunidad de madrid").replace(/navarra, comunidad foral de/g,"comunidad foral de navarra").replace(/murcia, región de/g,"regi\xF3n de murcia").replace(/principado de asturias/g,"principado de asturias").replace(/canarias/g,"canarias").replace(/castilla y león/g,"castilla y le\xF3n").replace(/valencia/g,"comunitat valenciana").replace(/país vasco/g,"pa\xEDs vasco").replace(/,/g,"").trim()}combineData(){console.log("Combined Data:",this.combinedData),console.log("Search Term in Filter:",this.searchTerm),this.populationData.length&&this.communities.length&&(this.combinedData=this.communities.map(e=>{let i=this.normalizeRegionName(e.name),c=this.populationData.filter(C=>this.normalizeRegionName(C.region).includes(i)).map(C=>C.population),m=c.length?Math.max(...c.filter(C=>C>0)):0;return!["ciudad aut\xF3noma de ceuta","principado de asturias","ciudad aut\xF3noma de melilla"].includes(i)&&m>0?G(Y({},e),{population:m,provinces:e.provinces.map(C=>{let E=this.normalizeRegionName(C.name),w=this.populationData.filter(L=>this.normalizeRegionName(L.region).includes(E)).map(L=>L.population),Me=w.length?Math.max(...w.filter(L=>L>0)):0;return G(Y({},C),{population:Me})})}):null}).filter(e=>e!==null),this.filteredData=this.combinedData)}handleSearch(e){this.searchTerm=e,console.log("Search Term:",this.searchTerm),this.filterData()}handleDebounce(e){this.searchTerm=e,this.filterData()}filterData(){if(!this.searchTerm.trim())this.filteredData=[...this.combinedData];else{let e=this.searchTerm.toLowerCase();this.filteredData=this.combinedData.filter(i=>this.normalizeRegionName(i.name).includes(e)||i.provinces.some(c=>this.normalizeRegionName(c.name).includes(e)))}}toggleProvinces(e){this.toggledCommunities[e]=!this.toggledCommunities[e]}static \u0275fac=function(i){return new(i||t)(g(Ie),g(De))};static \u0275cmp=f({type:t,selectors:[["app-provinces"]],decls:9,vars:3,consts:[[1,"container","my-4"],[1,"mb-4"],[1,"row","justify-content-center","mb-4"],[1,"col-12","col-md-6"],[3,"onValue","onDebounce","placeholder"],[1,"d-flex","justify-content-center","mb-4"],[4,"ngIf"],[1,"row"],["class","col-12 col-md-6 col-lg-4 mb-4",4,"ngFor","ngForOf"],[1,"col-12","col-md-6","col-lg-4","mb-4"],[1,"population-card","shadow-sm"],["mat-icon-button","",3,"click"],[4,"ngFor","ngForOf"]],template:function(i,c){i&1&&(o(0,"div",0),s(1,"hr",1),o(2,"div",2)(3,"div",3)(4,"shared-search-box",4),b("onValue",function(y){return c.handleSearch(y)})("onDebounce",function(y){return c.handleDebounce(y)}),n()()(),o(5,"div",5),d(6,He,1,0,"shared-loading-spiner",6),n(),o(7,"div",7),d(8,Ye,20,5,"div",8),n()()),i&2&&(a(4),l("placeholder","Search population by name..."),a(2),l("ngIf",c.isLoading),a(2),l("ngForOf",c.filteredData))},dependencies:[P,x,I,D,pe,me,ue,fe,ve,ge,de],styles:[".population-card[_ngcontent-%COMP%]{margin:20px;width:300px}"]})}return t})();var Ge=[{path:"",component:Pe,children:[{path:"by-capital",component:_e},{path:"by-country",component:be},{path:"by-region",component:Se},{path:"by/:id",component:Ee},{path:"populationcopy",component:Te},{path:"**",redirectTo:"by-capital"}]}],Le=(()=>{class t{static \u0275fac=function(i){return new(i||t)};static \u0275mod=O({type:t});static \u0275inj=k({imports:[K.forChild(Ge),K]})}return t})();var Rt=(()=>{class t{static \u0275fac=function(i){return new(i||t)};static \u0275mod=O({type:t});static \u0275inj=k({imports:[ae,Le,he]})}return t})();export{Rt as a};
